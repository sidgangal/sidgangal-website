---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import PostCard from '../../components/PostCard.astro';
import { sortByDate, groupByYear } from '../../utils/posts';

const entryDate = (p: any) => p.data.publishedAt;
const posts = sortByDate(await getCollection('thrive'), entryDate);
const yearGroups = groupByYear(posts, entryDate);
---

<BaseLayout title="Thrive" description="Sleep, nutrition, exercise, and sustainable high performance.">
  <header class="mb-8">
    <h1
      class="text-4xl mb-2"
      style="font-family: var(--font-heading); color: var(--color-thrive);"
    >
      Thrive
    </h1>
    <p style="color: var(--color-ink-light);" class="mb-4">
      Sleep, nutrition, exercise, and sustainable high performance.
    </p>
    <div class="prose prose-sm mb-6" style="color: var(--color-ink-muted);">
      <p>
        Seven years of startup grind left me chubby, unfit, and with blood work that scared me—high cholesterol, critically low vitamins, and inflammation markers that were aging me from the inside.
      </p>
      <p>
        Within a year of focused intervention, I brought my hsCRP from 1.6 to under 0.5. Now I'm studying longevity science from Peter Attia, David Sinclair, and Bryan Johnson—not to live forever, but to live well for as long as possible.
      </p>
      <p>
        This is where I share what actually works, backed by science.
      </p>
    </div>
  </header>

  {posts.length > 0 ? (
    yearGroups.map((group) => (
      <div class="mb-5">
        <h3
          class="text-xs font-[family-name:var(--font-mono)] mb-2"
          style="color: var(--color-ink-muted);"
        >
          {group.year}
        </h3>
        <ul class="list-none m-0 p-0">
          {group.posts.map((post) => (
            <PostCard
              title={post.data.title}
              href={`/thrive/${post.data.slug}`}
              pillar="thrive"
              publishedAt={post.data.publishedAt.toISOString()}
              showPillarTag={false}
            />
          ))}
        </ul>
      </div>
    ))
  ) : (
    <p style="color: var(--color-ink-muted);">No posts yet.</p>
  )}
</BaseLayout>
