---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import PostCard from '../../components/PostCard.astro';
import { sortByDate, groupByYear } from '../../utils/posts';

const entryDate = (p: any) => p.data.publishedAt;
const posts = sortByDate(await getCollection('invest'), entryDate);
const yearGroups = groupByYear(posts, entryDate);
---

<BaseLayout title="Invest" description="Markets, money, and long-term wealth building.">
  <header class="mb-8">
    <h1
      class="text-4xl mb-2"
      style="font-family: var(--font-heading); color: var(--color-invest);"
    >
      Invest
    </h1>
    <p style="color: var(--color-ink-light);" class="mb-4">
      Markets, money, and long-term wealth building.
    </p>
    <div class="prose prose-sm mb-6" style="color: var(--color-ink-muted);">
      <p>
        After selling my company, I had capital to deploy and zero experience in public markets. I spent a year studying while everyone else was buying into the 2022 euphoria. When markets crashed, I deployed.
      </p>
      <p>
        This is where I share my researchâ€”deep dives on companies I find interesting, frameworks for thinking about markets, and lessons from both wins and expensive mistakes (Bitcoin, Ethereum, and a startup that went belly up all taught me something).
      </p>
      <p>
        My approach: understand what you own, be patient in deployment, and never panic in drawdowns because you've done the work.
      </p>
    </div>
  </header>

  {posts.length > 0 ? (
    yearGroups.map((group) => (
      <div class="mb-5">
        <h3
          class="text-xs font-[family-name:var(--font-mono)] mb-2"
          style="color: var(--color-ink-muted);"
        >
          {group.year}
        </h3>
        <ul class="list-none m-0 p-0">
          {group.posts.map((post) => (
            <PostCard
              title={post.data.title}
              href={`/invest/${post.data.slug}`}
              pillar="invest"
              publishedAt={post.data.publishedAt.toISOString()}
              showPillarTag={false}
            />
          ))}
        </ul>
      </div>
    ))
  ) : (
    <p style="color: var(--color-ink-muted);">No posts yet.</p>
  )}
</BaseLayout>
